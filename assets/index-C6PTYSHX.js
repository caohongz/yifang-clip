import{d as Y,r as m,o as F,c as i,a as o,b as l,w as a,F as R,e as H,u as K,n as L,f as c,g as r,h as u,i as D,v as S,p as z,t as g,j as P,k as A,E as $,l as I}from"./index-au6lnfBI.js";import{d as C,g as q,_ as G}from"./_plugin-vue_export-helper-CnEB8DPd.js";const J={class:"project-list"},O={class:"header"},Q={key:0,class:"empty-state"},W={class:"empty-content"},X={key:1,class:"projects-grid text-base"},Z=["onClick"],ee=["src"],te={key:1,class:"placeholder"},le={class:"info"},ae={class:"flex justify-between items-center"},se=Y({__name:"index",setup(oe){K();const _=m([]),p=m(!1),d=m({name:""}),V=m(),f=m(!1),v=m(null);F(async()=>{b()});const b=async()=>{_.value=await C.projects.toArray(),_.value.forEach(async s=>{s.thumbnail=await q(s.thumbnail)})},x=()=>{p.value=!0,L(()=>{V.value.focus()})},k=async()=>{d.value.name&&(await C.projects.add({name:d.value.name,createTime:new Date().getTime(),tracks:[],thumbnail:""}),p.value=!1,d.value.name="",b())},T=s=>{const e=window.location.origin,y=window.location.pathname.split("/projects")[0],w=`${e}${y}#/clip/${s.id}`;window.open(w,"_blank")},U=s=>{v.value=s,f.value=!0},h=async()=>{var s;if((s=v.value)!=null&&s.id)try{await C.projects.delete(v.value.id),$.success("项目删除成功"),f.value=!1,v.value=null,await b()}catch(e){$.error("删除项目失败"),console.error("删除项目失败:",e)}},M=s=>I(s).format("YYYY-MM-DD HH:mm:ss");return(s,e)=>{const n=c("el-button"),y=c("el-icon"),w=c("el-input"),B=c("el-form-item"),E=c("el-form"),j=c("el-dialog");return r(),i("div",J,[o("div",O,[e[6]||(e[6]=o("h1",null,"我的剪辑项目",-1)),l(n,{type:"primary",onClick:x},{default:a(()=>e[5]||(e[5]=[u("新建项目")])),_:1})]),_.value.length?(r(),i("div",X,[(r(!0),i(R,null,H(_.value,t=>(r(),i("div",{key:t.id,class:"project-card"},[o("div",{class:"thumbnail",onClick:N=>T(t)},[t.thumbnail?(r(),i("img",{key:0,class:"rounded-t-xl",src:t.thumbnail,alt:"项目缩略图"},null,8,ee)):(r(),i("div",te,"无缩略图"))],8,Z),o("div",le,[o("div",ae,[o("h3",null,g(t.name),1),l(n,{type:"danger",size:"small",onClick:P(N=>U(t),["stop"])},{default:a(()=>e[10]||(e[10]=[u(" 删除 ")])),_:2},1032,["onClick"])]),o("p",null,"更新时间："+g(M(t.updateTime)),1)])]))),128))])):(r(),i("div",Q,[o("div",W,[l(y,{class:"empty-icon"},{default:a(()=>[l(D(S))]),_:1}),e[8]||(e[8]=o("p",{class:"empty-text"},"还没有创建任何项目",-1)),e[9]||(e[9]=o("p",{class:"empty-subtext"},'点击"新建项目"开始创作吧！',-1)),l(n,{type:"primary",class:"mt-4",onClick:x},{default:a(()=>[l(y,{class:"mr-2"},{default:a(()=>[l(D(z))]),_:1}),e[7]||(e[7]=u(" 新建项目 "))]),_:1})])])),l(j,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=t=>p.value=t),title:"新建项目"},{footer:a(()=>[l(n,{onClick:e[1]||(e[1]=t=>p.value=!1)},{default:a(()=>e[11]||(e[11]=[u("取消")])),_:1}),l(n,{type:"primary",onClick:k},{default:a(()=>e[12]||(e[12]=[u("确定")])),_:1})]),default:a(()=>[l(E,{model:d.value,onSubmit:P(k,["prevent"])},{default:a(()=>[l(B,{label:"项目名称"},{default:a(()=>[l(w,{modelValue:d.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>d.value.name=t),ref_key:"inputRef",ref:V,onKeyup:A(k,["enter"])},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(j,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=t=>f.value=t),title:"删除确认",width:"30%"},{footer:a(()=>[l(n,{onClick:e[3]||(e[3]=t=>f.value=!1)},{default:a(()=>e[13]||(e[13]=[u("取消")])),_:1}),l(n,{type:"danger",onClick:h},{default:a(()=>e[14]||(e[14]=[u("确定删除")])),_:1})]),default:a(()=>{var t;return[o("span",null,'确定要删除项目"'+g((t=v.value)==null?void 0:t.name)+'"吗？此操作不可恢复。',1)]}),_:1},8,["modelValue"])])}}}),re=G(se,[["__scopeId","data-v-cc1a22cb"]]);export{re as default};
